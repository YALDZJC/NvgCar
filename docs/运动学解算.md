# 运动学解算

## 麦克纳姆轮

### 逆解

$
\begin{cases}
\text{Motor}_0 &= \frac{1}{s} \big(-v_x + v_y + \omega \cdot (a + b) \big) \\
\text{Motor}_1 &= \frac{1}{s} \big(-v_x - v_y + \omega \cdot (a + b) \big) \\
\text{Motor}_2 &= \frac{1}{s} \big(v_x  - v_y + \omega \cdot (a + b) \big) \\
\text{Motor}_3 &= \frac{1}{s} \big(v_x  + v_y + \omega \cdot (a + b) \big)
\end{cases}
$

### 正解

$
\begin{cases}
\dfrac{1}{s} \left( -v_x + v_y + (a + b) \cdot \omega \right) = \omega_0 \\
\dfrac{1}{s} \left( -v_x - v_y + (a + b) \cdot \omega \right) = \omega_1 \\
\dfrac{1}{s} \left( v_x - v_y + (a + b) \cdot \omega \right) = \omega_2 \\
\dfrac{1}{s} \left( v_x + v_y + (a + b) \cdot \omega \right) = \omega_3
\end{cases}
$

### 符号说明

| 符号 | 含义                    | 单位               |
| ---- | ----------------------- | ------------------ |
| *s*  | 轮毂半径                | m（米）            |
| *a*  | 底盘中心 X 轴距离的一半 | m（米）            |
| *b*  | 底盘中心 Y 轴距离的一半 | m（米）            |
| *ω*  | 机器人绕 Z 轴角速度     | rad/s（弧度 / 秒） |

---

## 全向轮

### 逆解

$
\begin{cases}
Motor0 &= \frac{1}{s} \left( -\frac{\sqrt{2}}{2} v_x + \frac{\sqrt{2}}{2} v_y + \omega r \right) \\
Motor1 &= \frac{1}{s} \left( -\frac{\sqrt{2}}{2} v_x - \frac{\sqrt{2}}{2} v_y + \omega r \right) \\
Motor2 &= \frac{1}{s} \left( \frac{\sqrt{2}}{2} v_x - \frac{\sqrt{2}}{2} v_y + \omega r \right) \\
Motor3 &= \frac{1}{s} \left( \frac{\sqrt{2}}{2} v_x + \frac{\sqrt{2}}{2} v_y + \omega r \right)
\end{cases}
$

### 正解

$
\begin{cases}
\omega_0 = \frac{1}{s} \left( -\frac{\sqrt{2}}{2} v_x + \frac{\sqrt{2}}{2} v_y + \omega r \right) \\
\omega_1 = \frac{1}{s} \left( -\frac{\sqrt{2}}{2} v_x - \frac{\sqrt{2}}{2} v_y + \omega r \right) \\
\omega_2 = \frac{1}{s} \left( \frac{\sqrt{2}}{2} v_x - \frac{\sqrt{2}}{2} v_y + \omega r \right) \\
\omega_3 = \frac{1}{s} \left( \frac{\sqrt{2}}{2} v_x + \frac{\sqrt{2}}{2} v_y + \omega r \right)
\end{cases}
$

### 符号说明

| 符号 | 含义                         | 单位    |
| ---- | ---------------------------- | ------- |
| *s*  | 轮毂半径                     | m（米） |
| *r*  | 旋转中心到轮子中心的平面距离 | m（米） |
| *a*  | 底盘中心 X 轴距离的一半      | m（米） |
| *b*  | 底盘中心 Y 轴距离的一半      | m（米） |
| *ω*  | 机器人绕 Z 轴角速度          |         |

## 舵轮

### 逆解

$
\begin{cases}
Motor0 &= \frac{1}{s} \sqrt{(v_y - \omega \cos 45^\circ \cdot r)^2 + (v_x - \omega \sin 45^\circ \cdot r)^2} \\
Motor1 &= \frac{1}{s} \sqrt{(v_y - \omega \cos 45^\circ \cdot r)^2 + (v_x + \omega \sin 45^\circ \cdot r)^2} \\
Motor2 &= \frac{1}{s} \sqrt{(v_y + \omega \cos 45^\circ \cdot r)^2 + (v_x + \omega \sin 45^\circ \cdot r)^2} \\
Motor3 &= \frac{1}{s} \sqrt{(v_y + \omega \cos 45^\circ \cdot r)^2 + (v_x - \omega \sin 45^\circ \cdot r)^2} \\
\end{cases}
$

$
\begin{cases}
\theta_1 &= \tan^{-1} \frac{(v_y - \omega \cos 45^\circ \cdot r)}{(v_x - \omega \sin 45^\circ \cdot r)} \\
\theta_2 &= \tan^{-1} \frac{(v_y - \omega \cos 45^\circ \cdot r)}{(v_x + \omega \sin 45^\circ \cdot r)} \\
\theta_3 &= \tan^{-1} \frac{(v_y + \omega \cos 45^\circ \cdot r)}{(v_x + \omega \sin 45^\circ \cdot r)} \\
\theta_4 &= \tan^{-1} \frac{(v_y + \omega \cos 45^\circ \cdot r)}{(v_x - \omega \sin 45^\circ \cdot r)} 
\end{cases}
$



### 正解

$
\begin{cases}
\dfrac{1}{s} \left( v_x - \dfrac{\sqrt{2}}{2} r \omega \right) = \omega_{0x} \\
\dfrac{1}{s} \left( v_y + \dfrac{\sqrt{2}}{2} r \omega \right) = \omega_{0y} \\
\dfrac{1}{s} \left( v_x - \dfrac{\sqrt{2}}{2} r \omega \right) = \omega_{1x} \\
\dfrac{1}{s} \left( v_y + \dfrac{\sqrt{2}}{2} r \omega \right) = \omega_{1y} \\
\dfrac{1}{s} \left( v_x - \dfrac{\sqrt{2}}{2} r \omega \right) = \omega_{2x} \\
\dfrac{1}{s} \left( v_y + \dfrac{\sqrt{2}}{2} r \omega \right) = \omega_{2y} \\
\dfrac{1}{s} \left( v_x - \dfrac{\sqrt{2}}{2} r \omega \right) = \omega_{3x} \\
\dfrac{1}{s} \left( v_y + \dfrac{\sqrt{2}}{2} r \omega \right) = \omega_{3y}
\end{cases}
$

## 差速四轮

### 逆解
$
\begin{cases}
\text{Motor}_0 &=& \dfrac{v_x}{R_\omega} + \omega_z \times R_{4\omega} \times \dfrac{\sqrt{a^2 + b^2}}{R_\omega \times b} \\
\text{Motor}_1 &=& -\dfrac{v_x}{R_\omega} + \omega_z \times R_{4\omega} \times \dfrac{\sqrt{a^2 + b^2}}{R_\omega \times b} \\
\text{Motor}_2 &=& -\dfrac{v_x}{R_\omega} + \omega_z \times R_{4\omega} \times \dfrac{\sqrt{a^2 + b^2}}{R_\omega \times b} \\
\text{Motor}_3 &=& \dfrac{v_x}{R_\omega} + \omega_z \times R_{4\omega} \times \dfrac{\sqrt{a^2 + b^2}}{R_\omega \times b} 
\end{cases}
$

### 正解

$
\begin{cases}  v_x = \dfrac{R_\omega}{4}((\omega_1 + \omega_4) - (\omega_2 + \omega_3)) \\ \\ \omega_z = \dfrac{(\omega_1 + \omega_2 + \omega_3 + \omega_4)R_\omega b}{4R_{4\omega}\sqrt{a^2 + b^2}} \end{cases}
$

### 符号说明

| 变量符号 | 物理意义                                                     | 单位               |
| -------- | ------------------------------------------------------------ | ------------------ |
| *ω*      | 机器人四个轮子的角速度（转速）                               | rad/s（弧度 / 秒） |
| *υx*     | 机器人沿自身坐标系 X 轴方向的直线运动速度                    | m/s（米 / 秒）     |
| *Rω*     | 机器人轮子的半径                                             | m（米）            |
| *ωz*     | 机器人绕自身坐标系 Z 轴的旋转角速度                          | rad/s（弧度 / 秒） |
| *R4ω*    | 机器人旋转中心（坐标系原点）到单个轮子中心的距离（旋转半径） | m（米）            |
| *a*      | 旋转中心到轮子在 Y 轴方向（车体横向）的距离                  | m（米）            |
| *b*      | 旋转中心到轮子在 X 轴方向（车体纵向）的距离                  | m（米）            |
